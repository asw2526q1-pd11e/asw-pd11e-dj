<div class="post-card"
     style="
         background-color: #fff;
         border: 2px solid #d63384;
         border-radius: 10px;
         padding: 15px;
         margin-bottom: 20px;
         max-width: 700px;
         display: flex;
         gap: 15px;
         align-items: flex-start;
         box-shadow: 0 4px 8px rgba(0,0,0,0.05);
     ">

    {% if post.image %}
    <div style="flex-shrink: 0;">
        <a href="{% url 'blog:post_detail' post.pk %}" style="text-decoration: none;">
            <img src="{{ post.image.url }}" alt="{{ post.title }}"
                 style="width: 120px; height: 120px; object-fit: cover; border-radius: 10px; cursor: pointer;">
        </a>
    </div>
    {% endif %}

    <div style="display: flex; flex-direction: column; align-items: center; min-width: 40px; padding-top: 3px; flex-shrink: 0;">
        <form action="{% url 'blog:upvote_post' post.pk %}" method="post" style="margin:0;">
            {% csrf_token %}
            <button type="submit"
                    style="background:none; border:none; cursor:pointer; font-size:1.5em; padding:0; line-height:1; color:{% if user_vote == 1 %}#28a745{% else %}#666{% endif %};">
                â–²
            </button>
        </form>

        <span style="font-weight: bold; margin: 5px 0; font-size: 1.1em;">
            {{ post.votes }}
        </span>

        <form action="{% url 'blog:downvote_post' post.pk %}" method="post" style="margin:0;">
            {% csrf_token %}
            <button type="submit"
                    style="background:none; border:none; cursor:pointer; font-size:1.5em; padding:0; line-height:1; color:{% if user_vote == -1 %}#dc3545{% else %}#666{% endif %};">
                â–¼
            </button>
        </form>
    </div>

    <div style="flex: 1; min-width: 0;">
        <h2 style="margin: 0; font-size: 1.5em;">
            <a href="{% url 'blog:post_detail' post.pk %}" style="text-decoration:none; color:inherit; cursor:pointer;">
                {{ post.title }}
            </a>
            {% if post.url %}
            <a href="{{ post.url }}" target="_blank" title="Ver enlace relacionado" style="text-decoration:none; margin-left:8px;">
                ðŸ”—
            </a>
            {% endif %}
            {% if user == post.author %}
        <!-- Edit button visible only to the author -->
        <a href="{% url 'blog:post_edit' post.pk %}" class="btn-rose ms-2">
    Edit
</a>
    {% endif %}
            
        </h2>

        <p style="color: #666; margin-top: 5px;">
            Por
            <strong>
                <a href="{% url 'accounts:profile' post.author.username %}"
                   style="color:#d63384; text-decoration:none;">
                    {{ post.author.username }}
                </a>
            </strong> â€”
            <em>{{ post.published_date|date:"d M Y, H:i" }}</em>

            <button class="save-post-btn {% if post in user.profile.saved_posts.all %}saved{% endif %}" data-post-id="{{ post.id }}">
                {% if post in user.profile.saved_posts.all %}â˜…{% else %}â˜†{% endif %}
            </button>

        </p>

        {% if post.communities.exists %}
            <div style="margin-top: 5px; font-size: 0.95em;">
                <span style="color:#d63384; font-weight:bold;">Comunidades:</span>
                {% for community in post.communities.all %}
                    <a href="{% url 'communities:community_site' community.pk %}"
                       style="
                           display: inline-block;
                           background-color: #f8d7da;
                           color: #b30059;
                           text-decoration: none;
                           padding: 2px 8px;
                           border-radius: 12px;
                           margin-left: 4px;
                           font-size: 0.85em;
                           transition: background-color 0.2s;
                       "
                       onmouseover="this.style.backgroundColor='#f1b6c1'"
                       onmouseout="this.style.backgroundColor='#f8d7da'">
                        {{ community.name }}
                    </a>
                {% endfor %}
            </div>
        {% endif %}

        <p style="margin-top: 10px; color:#333;">{{ post.content }}</p>
    </div>
</div>

<style>
.btn-rose {
    border: 2px solid #d63384;
    color: #d63384;
    background-color: transparent;
    padding: 4px 10px;
    font-size: 0.8em;
    border-radius: 10px;
    text-decoration: none;
    transition: all 0.2s;
}

.btn-rose:hover {
    background-color: #d63384;
    color: #fff;
}
</style>
    .save-post-btn {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1.5em;
        color: #ffc107;
        padding: 0;
        line-height: 1;
        transition: color 0.3s;
    }

    .save-post-btn:hover {
        color: #ffb300;
    }

</style>

